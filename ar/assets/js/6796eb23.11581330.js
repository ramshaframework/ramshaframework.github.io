"use strict";(globalThis.webpackChunkramsha_doc=globalThis.webpackChunkramsha_doc||[]).push([[207],{1539:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>d,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"basics/architecture-and-templates/modularity","title":"Modularity","description":"Modularity is a core concept in the Ramsha Framework.","source":"@site/docs/basics/architecture-and-templates/modularity.md","sourceDirName":"basics/architecture-and-templates","slug":"/basics/architecture-and-templates/modularity","permalink":"/ar/docs/basics/architecture-and-templates/modularity","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/basics/architecture-and-templates/modularity.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Architectures & Templates","permalink":"/ar/docs/category/architectures--templates"},"next":{"title":"Clean Architecture","permalink":"/ar/docs/basics/architecture-and-templates/clean-architecture"}}');var s=r(4848),t=r(8453);const d={sidebar_position:1},l="Modularity",o={},c=[{value:"What Is Modularity?",id:"what-is-modularity",level:2},{value:"Why Modularity Matters",id:"why-modularity-matters",level:2},{value:"Modularity in Ramsha Framework",id:"modularity-in-ramsha-framework",level:2},{value:"Module Lifecycle",id:"module-lifecycle",level:2},{value:"Overview",id:"overview",level:3},{value:"Detailed Lifecycle",id:"detailed-lifecycle",level:2},{value:"1- Register Phase",id:"1--register-phase",level:3},{value:"2- Prepare Phase",id:"2--prepare-phase",level:3},{value:"3- BuildServices Phase",id:"3--buildservices-phase",level:3},{value:"4- OnInit Phase",id:"4--oninit-phase",level:3},{value:"5- OnShutdown Phase",id:"5--onshutdown-phase",level:3},{value:"Synchronous and Asynchronous Support",id:"synchronous-and-asynchronous-support",level:2},{value:"Creating Modules",id:"creating-modules",level:2},{value:"Simple Module",id:"simple-module",level:3},{value:"Feature Module",id:"feature-module",level:3},{value:"Module Dependencies",id:"module-dependencies",level:2},{value:"Declaring Dependencies",id:"declaring-dependencies",level:3},{value:"Dependency Resolution Order",id:"dependency-resolution-order",level:3},{value:"Avoiding Circular Dependencies",id:"avoiding-circular-dependencies",level:3},{value:"Lifecycle Phase Details",id:"lifecycle-phase-details",level:2},{value:"Next Steps",id:"next-steps",level:2}];function a(e){const n={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"modularity",children:"Modularity"})}),"\n",(0,s.jsxs)(n.p,{children:["Modularity is a core concept in the ",(0,s.jsx)(n.strong,{children:"Ramsha Framework"}),".",(0,s.jsx)(n.br,{}),"\n","It allows you to build applications as a collection of ",(0,s.jsx)(n.strong,{children:"independent, self-contained modules"}),", making your system easier to develop, test, and maintain."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"what-is-modularity",children:"What Is Modularity?"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Modularity"})," means organizing your application into separate modules, where each module:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Represents a specific feature or domain"}),"\n",(0,s.jsx)(n.li,{children:"Has a clear responsibility"}),"\n",(0,s.jsx)(n.li,{children:"Can be developed and maintained independently"}),"\n",(0,s.jsx)(n.li,{children:"Communicates with other modules through well-defined contracts"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"This approach helps prevent tightly coupled code and improves long-term maintainability."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"why-modularity-matters",children:"Why Modularity Matters"}),"\n",(0,s.jsxs)(n.p,{children:["Traditional monolithic applications often become difficult to maintain as they grow.",(0,s.jsx)(n.br,{}),"\n","Ramsha\u2019s modular design helps you avoid these problems by:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Reducing coupling between features"}),"\n",(0,s.jsx)(n.li,{children:"Making the codebase easier to understand"}),"\n",(0,s.jsx)(n.li,{children:"Allowing teams to work on different modules in parallel"}),"\n",(0,s.jsx)(n.li,{children:"Simplifying testing and refactoring"}),"\n",(0,s.jsx)(n.li,{children:"Enabling gradual system growth without breaking existing functionality"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"modularity-in-ramsha-framework",children:"Modularity in Ramsha Framework"}),"\n",(0,s.jsxs)(n.p,{children:["In Ramsha Framework, a ",(0,s.jsx)(n.strong,{children:"module"})," is a first-class building block of the application.",(0,s.jsx)(n.br,{}),"\n","Each module is represented by a class that ",(0,s.jsxs)(n.strong,{children:["inherits from ",(0,s.jsx)(n.code,{children:"RamshaModule"})]})," and participates in the application lifecycle."]}),"\n",(0,s.jsx)(n.p,{children:"A module can:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Declare dependencies on other modules"}),"\n",(0,s.jsx)(n.li,{children:"Prepare some configuration can be use before register services complete and build"}),"\n",(0,s.jsx)(n.li,{children:"Register services into the dependency injection container"}),"\n",(0,s.jsx)(n.li,{children:"Run logic during application startup"}),"\n",(0,s.jsx)(n.li,{children:"React to application shutdown"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["This design gives Ramsha a ",(0,s.jsx)(n.strong,{children:"structured, predictable, and extensible"})," modular system."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"module-lifecycle",children:"Module Lifecycle"}),"\n",(0,s.jsx)(n.h3,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(n.p,{children:"Every Ramsha module goes through five distinct lifecycle phases:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"1. Register    \u2192 Declare module dependencies\r\n2. Prepare     \u2192 Configure options can be access before register the services \r\n3. BuildServices \u2192 Register services in DI container\r\n4. OnInit      \u2192 Initialize when application starts\r\n5. OnShutdown  \u2192 Clean up when application stops\n"})}),"\n",(0,s.jsx)(n.h2,{id:"detailed-lifecycle",children:"Detailed Lifecycle"}),"\n",(0,s.jsx)(n.h3,{id:"1--register-phase",children:"1- Register Phase"}),"\n",(0,s.jsx)(n.p,{children:"The first phase where modules declare their dependencies on other modules:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"public class AppModule : RamshaModule\r\n{\r\n    public override void Register(RegisterContext context)\r\n    {\r\n        base.Register(context);\r\n        \r\n        // Declare dependencies\r\n        context.DependsOn<AspNetCoreMvcModule>();\r\n    }\r\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Key Points:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Dependencies are loaded before the module"}),"\n",(0,s.jsx)(n.li,{children:"Order matters: List dependencies in the order they should be initialized"}),"\n",(0,s.jsx)(n.li,{children:"Circular dependencies are not allowed"}),"\n",(0,s.jsx)(n.li,{children:"All dependencies must be available"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"2--prepare-phase",children:"2- Prepare Phase"}),"\n",(0,s.jsx)(n.p,{children:"Configure options and settings before services are registered and this options can be use when register the application services:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'public override void Prepare(PrepareContext context)\r\n{\r\n    base.Prepare(context);\r\n    \r\n    // Configure custom options\r\n    context.Configure<MyOptions>(options =>\r\n    {\r\n        options.Setting1 = "value1";\r\n        options.Setting2 = 42;\r\n    });\r\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Key Points:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Access to IConfiguration"}),"\n",(0,s.jsx)(n.li,{children:"Configure options before service registration"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"3--buildservices-phase",children:"3- BuildServices Phase"}),"\n",(0,s.jsx)(n.p,{children:"Register services in the dependency injection container:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"public override void BuildServices(BuildServicesContext context)\r\n{\r\n    base.BuildServices(context);\r\n    \r\n    // Register application services\r\n    context.Services.AddTransient<IProductService, ProductService>();\r\n    context.Services.AddScoped<IOrderService, OrderService>();\r\n    \r\n    // Register DbContext\r\n    context.Services.AddRamshaDbContext<AppDbContext>(options =>\r\n    {\r\n        options.AddDefaultRepositories(includeAllEntities: true);\r\n    });\r\n    \r\n    // Configure options\r\n    context.Services.Configure<MyServiceOptions>(options =>\r\n    {\r\n        options.ConnectionTimeout = TimeSpan.FromSeconds(30);\r\n    });\r\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Key Points:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Register all application services"}),"\n",(0,s.jsx)(n.li,{children:"Configure middleware and pipeline"}),"\n",(0,s.jsx)(n.li,{children:"Set up database contexts"}),"\n",(0,s.jsx)(n.li,{children:"Register repositories and data access"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"4--oninit-phase",children:"4- OnInit Phase"}),"\n",(0,s.jsx)(n.p,{children:"Initialize the module when the application starts:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'public override void OnInit(InitContext context)\r\n{\r\n    base.OnInit(context);\r\n    \r\n    // Get services from the container\r\n    var logger = context.ServiceProvider.GetRequiredService<ILogger<AppModule>>();\r\n    logger.LogInformation("AppModule initialized");\r\n    \r\n    // Perform startup tasks\r\n    var dataSeeder = context.ServiceProvider.GetRequiredService<IDataSeeder>();\r\n    dataSeeder.SeedAsync().GetAwaiter().GetResult();\r\n}\r\n\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Key Points:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Access to fully configured ServiceProvider"}),"\n",(0,s.jsx)(n.li,{children:"Perform data seeding"}),"\n",(0,s.jsx)(n.li,{children:"Run database migrations"}),"\n",(0,s.jsx)(n.li,{children:"Use or add Middlewares to pipeline"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"5--onshutdown-phase",children:"5- OnShutdown Phase"}),"\n",(0,s.jsx)(n.p,{children:"Clean up resources when the application stops:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'public override void OnShutdown(ShutdownContext context)\r\n{\r\n    base.OnShutdown(context);\r\n    \r\n    var logger = context.ServiceProvider.GetRequiredService<ILogger<AppModule>>();\r\n    logger.LogInformation("AppModule shutting down");\r\n}\r\n\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Key Points:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Close database connections"}),"\n",(0,s.jsx)(n.li,{children:"Flush caches"}),"\n",(0,s.jsx)(n.li,{children:"Log shutdown information"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"synchronous-and-asynchronous-support",children:"Synchronous and Asynchronous Support"}),"\n",(0,s.jsxs)(n.p,{children:["Each lifecycle method has an ",(0,s.jsx)(n.strong,{children:"async alternative"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"public virtual Task OnInitAsync(InitContext context)\n"})}),"\n",(0,s.jsx)(n.p,{children:"This allows modules to:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Perform async I/O"}),"\n",(0,s.jsx)(n.li,{children:"Await external services"}),"\n",(0,s.jsx)(n.li,{children:"Avoid blocking startup threads"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Ramsha automatically supports both sync and async execution paths."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"creating-modules",children:"Creating Modules"}),"\n",(0,s.jsx)(n.h3,{id:"simple-module",children:"Simple Module"}),"\n",(0,s.jsx)(n.p,{children:"A basic module with minimal configuration:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"\r\npublic class SimpleModule : RamshaModule\r\n{\r\n    public override void Register(RegisterContext context)\r\n    {\r\n        base.Register(context);\r\n        context.DependsOn<AspNetCoreMvcModule>();\r\n    }\r\n\r\n    public override void BuildServices(BuildServicesContext context)\r\n    {\r\n        base.BuildServices(context);\r\n        context.Services.AddTransient<IMyService, MyService>();\r\n    }\r\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"feature-module",children:"Feature Module"}),"\n",(0,s.jsx)(n.p,{children:"A module organizing a specific feature:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'public class ProductsModule : RamshaModule\r\n{\r\n    public override void Register(RegisterContext context)\r\n    {\r\n        base.Register(context);\r\n        \r\n        context\r\n            .DependsOn<EntityFrameworkCoreSqlServerModule>()\r\n            .DependsOn<AspNetCoreMvcModule>();\r\n    }\r\n\r\n    public override void Prepare(PrepareContext context)\r\n    {\r\n        base.Prepare(context);\r\n        \r\n        var configuration = context.GetConfiguration();\r\n        context.Configure<ProductsOptions>(configuration.GetSection("Products"));\r\n    }\r\n\r\n    public override void BuildServices(BuildServicesContext context)\r\n    {\r\n        base.BuildServices(context);\r\n\r\n        // Register services\r\n        context.Services.AddTransient<IProductService, ProductService>();\r\n\r\n        // get options that defined inside Prepare phase\r\n        var productOptions = context.Services.ExecutePreparedOptions<ProductsOptions>();\r\n      \r\n        context.Services.AddRamshaDbContext<AppDbContext>(options =>\r\n        {\r\n            optiona\r\n            .AddDefaultRepositories(includeAllEntities:productOptions.IncludeAllEntities)\r\n            .AddRepository<Product,IProductRepository,ProductRepository>();\r\n        });\r\n    \r\n    }\r\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"module-dependencies",children:"Module Dependencies"}),"\n",(0,s.jsx)(n.h3,{id:"declaring-dependencies",children:"Declaring Dependencies"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"public class AppModule : RamshaModule\r\n{\r\n    public override void Register(RegisterContext context)\r\n    {\r\n        base.Register(context);\r\n        \r\n        // Single dependency\r\n        context.DependsOn<AspNetCoreMvcModule>();\r\n        \r\n        // Multiple dependencies (chained)\r\n        context\r\n            .DependsOn<EntityFrameworkCoreSqlServerModule>()\r\n            .DependsOn<IdentityApplicationModule>()\r\n            .DependsOn<PermissionsApplicationModule>();\r\n    }\r\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"dependency-resolution-order",children:"Dependency Resolution Order"}),"\n",(0,s.jsx)(n.p,{children:"Modules are initialized in dependency order:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"AppModule depends on:\r\n  \u2514\u2500 IdentityModule depends on:\r\n      \u2514\u2500 EntityFrameworkCoreModule depends on:\r\n          \u2514\u2500 CoreModule\r\n\r\nInitialization order:\r\n1. CoreModule\r\n2. EntityFrameworkCoreModule\r\n3. IdentityModule\r\n4. AppModule\n"})}),"\n",(0,s.jsx)(n.h3,{id:"avoiding-circular-dependencies",children:"Avoiding Circular Dependencies"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Bad Example:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"// ModuleA depends on ModuleB\r\npublic class ModuleA : RamshaModule\r\n{\r\n    public override void Register(RegisterContext context)\r\n    {\r\n        context.DependsOn<ModuleB>();  // \u274c Circular dependency!\r\n    }\r\n}\r\n\r\n// ModuleB depends on ModuleA\r\npublic class ModuleB : RamshaModule\r\n{\r\n    public override void Register(RegisterContext context)\r\n    {\r\n        context.DependsOn<ModuleA>();  // \u274c Circular dependency!\r\n    }\r\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Good Example:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"// Extract common functionality to a shared module\r\npublic class SharedModule : RamshaModule { }\r\n\r\npublic class ModuleA : RamshaModule\r\n{\r\n    public override void Register(RegisterContext context)\r\n    {\r\n        context.DependsOn<SharedModule>();  // \u2713 Both depend on shared module\r\n    }\r\n}\r\n\r\npublic class ModuleB : RamshaModule\r\n{\r\n    public override void Register(RegisterContext context)\r\n    {\r\n        context.DependsOn<SharedModule>();  // \u2713 No circular dependency\r\n    }\r\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"lifecycle-phase-details",children:"Lifecycle Phase Details"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Phase"}),(0,s.jsx)(n.th,{children:"Purpose"}),(0,s.jsx)(n.th,{children:"Key Actions"}),(0,s.jsx)(n.th,{children:"When to Use"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Register"})}),(0,s.jsx)(n.td,{children:"Declare dependencies"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"context.DependsOn<T>()"})}),(0,s.jsx)(n.td,{children:"Module requires other modules"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Prepare"})}),(0,s.jsx)(n.td,{children:"Pre-configuration"}),(0,s.jsx)(n.td,{children:"Setup module state before DI"}),(0,s.jsx)(n.td,{children:"Early initialization logic"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Build Services"})}),(0,s.jsx)(n.td,{children:"Service registration"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"context.Services.AddX()"})}),(0,s.jsx)(n.td,{children:"Register DI services"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"OnInit"})}),(0,s.jsx)(n.td,{children:"Runtime setup"}),(0,s.jsx)(n.td,{children:"Database seeding, cache warming"}),(0,s.jsx)(n.td,{children:"Post-DI initialization"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"OnShutdown"})}),(0,s.jsx)(n.td,{children:"Cleanup"}),(0,s.jsx)(n.td,{children:"Close connections, release resources"}),(0,s.jsx)(n.td,{children:"Graceful shutdown"})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,s.jsx)(n.p,{children:"Continue learning about Ramsha architecture:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.a,{href:"./clean-architecture",children:"Clean Architecture"})})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.a,{href:"./ramsha-templates/solution-templates",children:"Solution Templates"})})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>d,x:()=>l});var i=r(6540);const s={},t=i.createContext(s);function d(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);