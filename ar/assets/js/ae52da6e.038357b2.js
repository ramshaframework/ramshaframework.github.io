"use strict";(globalThis.webpackChunkramsha_doc=globalThis.webpackChunkramsha_doc||[]).push([[9006],{8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>o});var i=s(6540);const t={},r=i.createContext(t);function l(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),i.createElement(r.Provider,{value:n},e.children)}},9432:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"basics/settings","title":"Settings","description":"Overview","source":"@site/docs/basics/settings.md","sourceDirName":"basics","slug":"/basics/settings","permalink":"/ar/docs/basics/settings","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Unit of Work","permalink":"/ar/docs/basics/persistence/unit-of-work"},"next":{"title":"Authorization","permalink":"/ar/docs/basics/authorization"}}');var t=s(4848),r=s(8453);const l={sidebar_position:3},o="Settings",d={},c=[{value:"Overview",id:"overview",level:2},{value:"Core Concepts",id:"core-concepts",level:2},{value:"What Is a Setting?",id:"what-is-a-setting",level:3},{value:"Defining Settings Models",id:"defining-settings-models",level:2},{value:"Example: Product Discount Settings",id:"example-product-discount-settings",level:3},{value:"Defining Setting Names",id:"defining-setting-names",level:2},{value:"Setting Definitions",id:"setting-definitions",level:2},{value:"Explanation",id:"explanation",level:3},{value:"Creating Setting Definition Providers",id:"creating-setting-definition-providers",level:2},{value:"What This Does",id:"what-this-does",level:3},{value:"Registering Setting Definitions",id:"registering-setting-definitions",level:2},{value:"Setting Value Resolvers",id:"setting-value-resolvers",level:2},{value:"Built-in Resolvers",id:"built-in-resolvers",level:2},{value:"Configuration Setting Resolver",id:"configuration-setting-resolver",level:3},{value:"Memory (Default) Setting Resolver",id:"memory-default-setting-resolver",level:3},{value:"Registering Setting Value Resolvers",id:"registering-setting-value-resolvers",level:2},{value:"Resolver Order Matters",id:"resolver-order-matters",level:3},{value:"Custom Resolvers",id:"custom-resolvers",level:2},{value:"Provider-Based Resolution",id:"provider-based-resolution",level:2},{value:"Resolving Settings Using ISettingResolver",id:"resolving-settings-using-isettingresolver",level:2},{value:"Summary",id:"summary",level:2},{value:"Next Steps",id:"next-steps",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"settings",children:"Settings"})}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsxs)(n.p,{children:["Ramsha Framework provides a ",(0,t.jsx)(n.strong,{children:"powerful, extensible, and strongly-typed settings system"})," designed to centralize application configuration while keeping it ",(0,t.jsx)(n.strong,{children:"explicit, predictable, and scalable"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"Ramsha settings:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Are defined centrally"}),"\n",(0,t.jsx)(n.li,{children:"Are strongly typed"}),"\n",(0,t.jsx)(n.li,{children:"Support default values"}),"\n",(0,t.jsx)(n.li,{children:"Are grouped logically"}),"\n",(0,t.jsx)(n.li,{children:"Can be resolved from multiple sources"}),"\n",(0,t.jsx)(n.li,{children:"Are fully extensible via custom resolvers"}),"\n",(0,t.jsx)(n.li,{children:"Allow fine-grained control over resolution order"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"core-concepts",children:"Core Concepts"}),"\n",(0,t.jsx)(n.h3,{id:"what-is-a-setting",children:"What Is a Setting?"}),"\n",(0,t.jsxs)(n.p,{children:["A ",(0,t.jsx)(n.strong,{children:"setting"})," represents a configurable value that affects application behavior, such as:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Business rules"}),"\n",(0,t.jsx)(n.li,{children:"Feature toggles"}),"\n",(0,t.jsx)(n.li,{children:"Thresholds and limits"}),"\n",(0,t.jsx)(n.li,{children:"Application-level options"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"defining-settings-models",children:"Defining Settings Models"}),"\n",(0,t.jsxs)(n.p,{children:["Settings values are represented using ",(0,t.jsx)(n.strong,{children:"plain C# classes"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"example-product-discount-settings",children:"Example: Product Discount Settings"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"public class ProductDiscountSettings\n{\n    public int Discount { get; set; }\n    public bool HasDiscount { get; set; }\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:"This ensures:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Strong typing"}),"\n",(0,t.jsx)(n.li,{children:"IntelliSense support"}),"\n",(0,t.jsx)(n.li,{children:"Compile-time safety"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"defining-setting-names",children:"Defining Setting Names"}),"\n",(0,t.jsx)(n.p,{children:"Setting names should always be centralized to avoid magic strings."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'public class ProductSettingNames\n{\n    public const string GroupName = "ProductsSettings";\n    public const string DiscountSettings = "DiscountSettings";\n}\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"setting-definitions",children:"Setting Definitions"}),"\n",(0,t.jsxs)(n.p,{children:["Internally, every setting is represented by a ",(0,t.jsx)(n.code,{children:"SettingDefinition"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"public class SettingDefinition\n{\n    public string Name { get; set; }\n    public string? GroupName { get; set; }\n    public Type ValueType { get; set; }\n    public string? Description { get; set; }\n    public object? DefaultValue { get; set; }\n    public List<string> Providers { get; set; } = [];\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"explanation",children:"Explanation"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Property"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"Name"})}),(0,t.jsx)(n.td,{children:"Unique name of the setting"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"GroupName"})}),(0,t.jsx)(n.td,{children:"Optional group name"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"ValueType"})}),(0,t.jsx)(n.td,{children:"CLR type of the value"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"Description"})}),(0,t.jsx)(n.td,{children:"Optional description"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"DefaultValue"})}),(0,t.jsx)(n.td,{children:"Fallback value"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"Providers"})}),(0,t.jsx)(n.td,{children:"Allowed resolver provider names"})]})]})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"creating-setting-definition-providers",children:"Creating Setting Definition Providers"}),"\n",(0,t.jsxs)(n.p,{children:["Settings are defined using ",(0,t.jsx)(n.strong,{children:"Setting Definition Providers"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"public class ProductSettingDefinitions : ISettingDefinitionProvider\n{\n    public void Define(ISettingDefinitionContext context)\n    {\n        context.Group(ProductSettingNames.GroupName, group =>\n        {\n            group.Setting(\n                ProductSettingNames.DiscountSettings,\n                new ProductDiscountSettings\n                {\n                    Discount = 20,\n                    HasDiscount = true\n                });\n        });\n    }\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"what-this-does",children:"What This Does"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Creates a settings group"}),"\n",(0,t.jsx)(n.li,{children:"Defines a setting"}),"\n",(0,t.jsx)(n.li,{children:"Assigns a strongly typed default value"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"registering-setting-definitions",children:"Registering Setting Definitions"}),"\n",(0,t.jsxs)(n.p,{children:["Setting definitions must be registered during the ",(0,t.jsx)(n.strong,{children:"BuildServices phase"})," of a module."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"public override void BuildServices(BuildServicesContext context)\n{\n    context.Services.Configure<RamshaSettingsOptions>(options =>\n    {\n        options.DefinitionProviders.Add<ProductSettingDefinitions>();\n    });\n}\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"setting-value-resolvers",children:"Setting Value Resolvers"}),"\n",(0,t.jsxs)(n.p,{children:["Settings values are resolved using ",(0,t.jsx)(n.strong,{children:"Setting Value Resolvers"}),", which determine ",(0,t.jsx)(n.strong,{children:"where a setting value comes from"}),", such as:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Configuration"}),"\n",(0,t.jsx)(n.li,{children:"Memory defaults"}),"\n",(0,t.jsx)(n.li,{children:"Database"}),"\n",(0,t.jsx)(n.li,{children:"External systems"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"All resolvers inherit from:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"SettingValueResolver\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Each resolver has a ",(0,t.jsx)(n.strong,{children:"provider name"}),", which uniquely identifies it."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"built-in-resolvers",children:"Built-in Resolvers"}),"\n",(0,t.jsx)(n.h3,{id:"configuration-setting-resolver",children:"Configuration Setting Resolver"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'public class ConfigurationSettingValueResolver(IConfiguration configuration)\n    : SettingValueResolver("C")\n{\n    public override Task<T?> ResolveAsync<T>(SettingDefinition def)\n        where T : default\n    {\n        var section = def.GroupName is not null\n            ? configuration.GetSection(def.GroupName).GetSection(def.Name)\n            : configuration.GetSection(def.Name);\n\n        return Task.FromResult(section.Get<T>());\n    }\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Provider Name:"})," ",(0,t.jsx)(n.code,{children:"C"}),"\nReads values from configuration sources."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"memory-default-setting-resolver",children:"Memory (Default) Setting Resolver"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'public class MemorySettingValueResolver()\n    : SettingValueResolver("M")\n{\n    public override Task<T?> ResolveAsync<T>(SettingDefinition def)\n        where T : default\n    {\n        return Task.FromResult(\n            def.DefaultValue is not null\n                ? (T)def.DefaultValue\n                : default\n        );\n    }\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Provider Name:"})," ",(0,t.jsx)(n.code,{children:"M"}),"\nBehavior: returns the default value defined in the ",(0,t.jsx)(n.code,{children:"SettingDefinition"}),"."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"registering-setting-value-resolvers",children:"Registering Setting Value Resolvers"}),"\n",(0,t.jsxs)(n.p,{children:["Resolvers are registered in ",(0,t.jsx)(n.strong,{children:"RamshaSettingsOptions"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"services.Configure<RamshaSettingsOptions>(options =>\n{\n    options.ValueResolvers.Add<ConfigurationSettingValueResolver>();\n    options.ValueResolvers.Add<MemorySettingValueResolver>();\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"resolver-order-matters",children:"Resolver Order Matters"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Resolvers are executed ",(0,t.jsx)(n.strong,{children:"in the order they appear"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["The first resolver that returns a value ",(0,t.jsx)(n.strong,{children:"wins"}),"."]}),"\n",(0,t.jsx)(n.li,{children:"You can control the order using:"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"options.ValueResolvers.AddBefore<MemorySettingValueResolver, CustomResolver>();\noptions.ValueResolvers.AddAfter<ConfigurationSettingValueResolver, CustomResolver>();\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"custom-resolvers",children:"Custom Resolvers"}),"\n",(0,t.jsxs)(n.p,{children:["You can create custom resolvers by inheriting from ",(0,t.jsx)(n.code,{children:"SettingValueResolver"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'public class CustomSettingResolver : SettingValueResolver("X")\n{\n    public override Task<T?> ResolveAsync<T>(SettingDefinition def)\n        where T : default\n    {\n        // custom logic\n        return Task.FromResult(default(T));\n    }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"Then register it:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"services.Configure<RamshaSettingsOptions>(options =>\n{\n    options.ValueResolvers.Add<CustomSettingResolver>();\n});\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"provider-based-resolution",children:"Provider-Based Resolution"}),"\n",(0,t.jsxs)(n.p,{children:["Each ",(0,t.jsx)(n.code,{children:"SettingDefinition"})," can specify ",(0,t.jsx)(n.strong,{children:"allowed provider names"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["If ",(0,t.jsx)(n.code,{children:"Providers"})," is empty: all resolvers are allowed"]}),"\n",(0,t.jsxs)(n.li,{children:["If ",(0,t.jsx)(n.code,{children:"Providers"})," contains provider names: only resolvers with matching names execute"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'group.Setting(\n    ProductSettingNames.DiscountSettings,\n    new ProductDiscountSettings { Discount = 20, HasDiscount = true },\n    providers: new[] { "C" } // only configuration resolver\n);\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"resolving-settings-using-isettingresolver",children:"Resolving Settings Using ISettingResolver"}),"\n",(0,t.jsxs)(n.p,{children:["Settings are consumed via ",(0,t.jsx)(n.code,{children:"ISettingResolver"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"public class AppSettingsController(\n    ISettingResolver settingResolver\n) : RamshaApiController\n{\n    [HttpGet(nameof(GetProductDiscountSettings))]\n    public async Task<ProductDiscountSettings?> GetProductDiscountSettings()\n    {\n        return await settingResolver.ResolveAsync<ProductDiscountSettings>(\n            ProductSettingNames.DiscountSettings\n        );\n    }\n}\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Finds the setting definition"}),"\n",(0,t.jsx)(n.li,{children:"Applies provider filtering"}),"\n",(0,t.jsx)(n.li,{children:"Executes resolvers in order"}),"\n",(0,t.jsx)(n.li,{children:"Returns strongly typed value"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,t.jsx)(n.p,{children:"Ramsha Settings System:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Centralizes settings definitions"}),"\n",(0,t.jsx)(n.li,{children:"Supports multiple value sources via resolvers"}),"\n",(0,t.jsxs)(n.li,{children:["Provides fine-grained control over ",(0,t.jsx)(n.strong,{children:"resolver order"})]}),"\n",(0,t.jsxs)(n.li,{children:["Allows ",(0,t.jsx)(n.strong,{children:"custom resolvers"})]}),"\n",(0,t.jsxs)(n.li,{children:["Supports ",(0,t.jsx)(n.strong,{children:"provider-based filtering"})]}),"\n",(0,t.jsx)(n.li,{children:"Provides safe defaults"}),"\n",(0,t.jsxs)(n.li,{children:["Ensures ",(0,t.jsx)(n.strong,{children:"explicit, predictable, and strongly typed configuration"})]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"This design makes your configuration:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Clear"}),"\n",(0,t.jsx)(n.li,{children:"Maintainable"}),"\n",(0,t.jsx)(n.li,{children:"Flexible"}),"\n",(0,t.jsx)(n.li,{children:"Fully aligned with Clean Architecture principles"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"./authorization",children:"Authorization"})})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"../basics/messaging/local-messaging",children:"Local Messaging"})})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}}}]);