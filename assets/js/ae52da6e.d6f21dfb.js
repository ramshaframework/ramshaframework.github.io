"use strict";(globalThis.webpackChunkramsha_doc=globalThis.webpackChunkramsha_doc||[]).push([[9006],{8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>o});var i=s(6540);const r={},t=i.createContext(r);function l(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(t.Provider,{value:n},e.children)}},9432:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"basics/settings","title":"Settings","description":"Overview","source":"@site/docs/basics/settings.md","sourceDirName":"basics","slug":"/basics/settings","permalink":"/docs/basics/settings","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/basics/settings.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Unit of Work","permalink":"/docs/basics/infrastructure/unit-of-work"},"next":{"title":"Authorization","permalink":"/docs/basics/authorization"}}');var r=s(4848),t=s(8453);const l={sidebar_position:3},o="Settings",d={},c=[{value:"Overview",id:"overview",level:2},{value:"Core Concepts",id:"core-concepts",level:2},{value:"What Is a Setting?",id:"what-is-a-setting",level:3},{value:"Defining Settings Models",id:"defining-settings-models",level:2},{value:"Example: Product Discount Settings",id:"example-product-discount-settings",level:3},{value:"Defining Setting Names",id:"defining-setting-names",level:2},{value:"Setting Definitions",id:"setting-definitions",level:2},{value:"Explanation",id:"explanation",level:3},{value:"Creating Setting Definition Providers",id:"creating-setting-definition-providers",level:2},{value:"What This Does",id:"what-this-does",level:3},{value:"Registering Setting Definitions",id:"registering-setting-definitions",level:2},{value:"Setting Value Resolvers",id:"setting-value-resolvers",level:2},{value:"Built-in Resolvers",id:"built-in-resolvers",level:2},{value:"Configuration Setting Resolver",id:"configuration-setting-resolver",level:3},{value:"Memory (Default) Setting Resolver",id:"memory-default-setting-resolver",level:3},{value:"Registering Setting Value Resolvers",id:"registering-setting-value-resolvers",level:2},{value:"Resolver Order Matters",id:"resolver-order-matters",level:3},{value:"Custom Resolvers",id:"custom-resolvers",level:2},{value:"Provider-Based Resolution",id:"provider-based-resolution",level:2},{value:"Resolving Settings Using ISettingResolver",id:"resolving-settings-using-isettingresolver",level:2},{value:"Summary",id:"summary",level:2},{value:"Next Steps",id:"next-steps",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"settings",children:"Settings"})}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(n.p,{children:["Ramsha Framework provides a ",(0,r.jsx)(n.strong,{children:"powerful, extensible, and strongly-typed settings system"})," designed to centralize application configuration while keeping it ",(0,r.jsx)(n.strong,{children:"explicit, predictable, and scalable"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"Ramsha settings:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Are defined centrally"}),"\n",(0,r.jsx)(n.li,{children:"Are strongly typed"}),"\n",(0,r.jsx)(n.li,{children:"Support default values"}),"\n",(0,r.jsx)(n.li,{children:"Are grouped logically"}),"\n",(0,r.jsx)(n.li,{children:"Can be resolved from multiple sources"}),"\n",(0,r.jsx)(n.li,{children:"Are fully extensible via custom resolvers"}),"\n",(0,r.jsx)(n.li,{children:"Allow fine-grained control over resolution order"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"core-concepts",children:"Core Concepts"}),"\n",(0,r.jsx)(n.h3,{id:"what-is-a-setting",children:"What Is a Setting?"}),"\n",(0,r.jsxs)(n.p,{children:["A ",(0,r.jsx)(n.strong,{children:"setting"})," represents a configurable value that affects application behavior, such as:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Business rules"}),"\n",(0,r.jsx)(n.li,{children:"Feature toggles"}),"\n",(0,r.jsx)(n.li,{children:"Thresholds and limits"}),"\n",(0,r.jsx)(n.li,{children:"Application-level options"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"defining-settings-models",children:"Defining Settings Models"}),"\n",(0,r.jsxs)(n.p,{children:["Settings values are represented using ",(0,r.jsx)(n.strong,{children:"plain C# classes"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"example-product-discount-settings",children:"Example: Product Discount Settings"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"public class ProductDiscountSettings\r\n{\r\n    public int Discount { get; set; }\r\n    public bool HasDiscount { get; set; }\r\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:"This ensures:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Strong typing"}),"\n",(0,r.jsx)(n.li,{children:"IntelliSense support"}),"\n",(0,r.jsx)(n.li,{children:"Compile-time safety"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"defining-setting-names",children:"Defining Setting Names"}),"\n",(0,r.jsx)(n.p,{children:"Setting names should always be centralized to avoid magic strings."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'public class ProductSettingNames\r\n{\r\n    public const string GroupName = "ProductsSettings";\r\n    public const string DiscountSettings = "DiscountSettings";\r\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"setting-definitions",children:"Setting Definitions"}),"\n",(0,r.jsxs)(n.p,{children:["Internally, every setting is represented by a ",(0,r.jsx)(n.code,{children:"SettingDefinition"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"public class SettingDefinition\r\n{\r\n    public string Name { get; set; }\r\n    public string? GroupName { get; set; }\r\n    public Type ValueType { get; set; }\r\n    public string? Description { get; set; }\r\n    public object? DefaultValue { get; set; }\r\n    public List<string> Providers { get; set; } = [];\r\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"explanation",children:"Explanation"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Property"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Name"})}),(0,r.jsx)(n.td,{children:"Unique name of the setting"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"GroupName"})}),(0,r.jsx)(n.td,{children:"Optional group name"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"ValueType"})}),(0,r.jsx)(n.td,{children:"CLR type of the value"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Description"})}),(0,r.jsx)(n.td,{children:"Optional description"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"DefaultValue"})}),(0,r.jsx)(n.td,{children:"Fallback value"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Providers"})}),(0,r.jsx)(n.td,{children:"Allowed resolver provider names"})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"creating-setting-definition-providers",children:"Creating Setting Definition Providers"}),"\n",(0,r.jsxs)(n.p,{children:["Settings are defined using ",(0,r.jsx)(n.strong,{children:"Setting Definition Providers"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"public class ProductSettingDefinitions : ISettingDefinitionProvider\r\n{\r\n    public void Define(ISettingDefinitionContext context)\r\n    {\r\n        context.Group(ProductSettingNames.GroupName, group =>\r\n        {\r\n            group.Setting(\r\n                ProductSettingNames.DiscountSettings,\r\n                new ProductDiscountSettings\r\n                {\r\n                    Discount = 20,\r\n                    HasDiscount = true\r\n                });\r\n        });\r\n    }\r\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"what-this-does",children:"What This Does"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Creates a settings group"}),"\n",(0,r.jsx)(n.li,{children:"Defines a setting"}),"\n",(0,r.jsx)(n.li,{children:"Assigns a strongly typed default value"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"registering-setting-definitions",children:"Registering Setting Definitions"}),"\n",(0,r.jsxs)(n.p,{children:["Setting definitions must be registered during the ",(0,r.jsx)(n.strong,{children:"BuildServices phase"})," of a module."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"public override void BuildServices(BuildServicesContext context)\r\n{\r\n    context.Services.Configure<RamshaSettingsOptions>(options =>\r\n    {\r\n        options.DefinitionProviders.Add<ProductSettingDefinitions>();\r\n    });\r\n}\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"setting-value-resolvers",children:"Setting Value Resolvers"}),"\n",(0,r.jsxs)(n.p,{children:["Settings values are resolved using ",(0,r.jsx)(n.strong,{children:"Setting Value Resolvers"}),", which determine ",(0,r.jsx)(n.strong,{children:"where a setting value comes from"}),", such as:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Configuration"}),"\n",(0,r.jsx)(n.li,{children:"Memory defaults"}),"\n",(0,r.jsx)(n.li,{children:"Database"}),"\n",(0,r.jsx)(n.li,{children:"External systems"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"All resolvers inherit from:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"SettingValueResolver\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Each resolver has a ",(0,r.jsx)(n.strong,{children:"provider name"}),", which uniquely identifies it."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"built-in-resolvers",children:"Built-in Resolvers"}),"\n",(0,r.jsx)(n.h3,{id:"configuration-setting-resolver",children:"Configuration Setting Resolver"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'public class ConfigurationSettingValueResolver(IConfiguration configuration)\r\n    : SettingValueResolver("C")\r\n{\r\n    public override Task<T?> ResolveAsync<T>(SettingDefinition def)\r\n        where T : default\r\n    {\r\n        var section = def.GroupName is not null\r\n            ? configuration.GetSection(def.GroupName).GetSection(def.Name)\r\n            : configuration.GetSection(def.Name);\r\n\r\n        return Task.FromResult(section.Get<T>());\r\n    }\r\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Provider Name:"})," ",(0,r.jsx)(n.code,{children:"C"}),"\r\nReads values from configuration sources."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"memory-default-setting-resolver",children:"Memory (Default) Setting Resolver"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'public class MemorySettingValueResolver()\r\n    : SettingValueResolver("M")\r\n{\r\n    public override Task<T?> ResolveAsync<T>(SettingDefinition def)\r\n        where T : default\r\n    {\r\n        return Task.FromResult(\r\n            def.DefaultValue is not null\r\n                ? (T)def.DefaultValue\r\n                : default\r\n        );\r\n    }\r\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Provider Name:"})," ",(0,r.jsx)(n.code,{children:"M"}),"\r\nBehavior: returns the default value defined in the ",(0,r.jsx)(n.code,{children:"SettingDefinition"}),"."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"registering-setting-value-resolvers",children:"Registering Setting Value Resolvers"}),"\n",(0,r.jsxs)(n.p,{children:["Resolvers are registered in ",(0,r.jsx)(n.strong,{children:"RamshaSettingsOptions"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"services.Configure<RamshaSettingsOptions>(options =>\r\n{\r\n    options.ValueResolvers.Add<ConfigurationSettingValueResolver>();\r\n    options.ValueResolvers.Add<MemorySettingValueResolver>();\r\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"resolver-order-matters",children:"Resolver Order Matters"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Resolvers are executed ",(0,r.jsx)(n.strong,{children:"in the order they appear"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["The first resolver that returns a value ",(0,r.jsx)(n.strong,{children:"wins"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"You can control the order using:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"options.ValueResolvers.AddBefore<MemorySettingValueResolver, CustomResolver>();\r\noptions.ValueResolvers.AddAfter<ConfigurationSettingValueResolver, CustomResolver>();\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"custom-resolvers",children:"Custom Resolvers"}),"\n",(0,r.jsxs)(n.p,{children:["You can create custom resolvers by inheriting from ",(0,r.jsx)(n.code,{children:"SettingValueResolver"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'public class CustomSettingResolver : SettingValueResolver("X")\r\n{\r\n    public override Task<T?> ResolveAsync<T>(SettingDefinition def)\r\n        where T : default\r\n    {\r\n        // custom logic\r\n        return Task.FromResult(default(T));\r\n    }\r\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"Then register it:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"services.Configure<RamshaSettingsOptions>(options =>\r\n{\r\n    options.ValueResolvers.Add<CustomSettingResolver>();\r\n});\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"provider-based-resolution",children:"Provider-Based Resolution"}),"\n",(0,r.jsxs)(n.p,{children:["Each ",(0,r.jsx)(n.code,{children:"SettingDefinition"})," can specify ",(0,r.jsx)(n.strong,{children:"allowed provider names"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["If ",(0,r.jsx)(n.code,{children:"Providers"})," is empty: all resolvers are allowed"]}),"\n",(0,r.jsxs)(n.li,{children:["If ",(0,r.jsx)(n.code,{children:"Providers"})," contains provider names: only resolvers with matching names execute"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'group.Setting(\r\n    ProductSettingNames.DiscountSettings,\r\n    new ProductDiscountSettings { Discount = 20, HasDiscount = true },\r\n    providers: new[] { "C" } // only configuration resolver\r\n);\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"resolving-settings-using-isettingresolver",children:"Resolving Settings Using ISettingResolver"}),"\n",(0,r.jsxs)(n.p,{children:["Settings are consumed via ",(0,r.jsx)(n.code,{children:"ISettingResolver"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"public class AppSettingsController(\r\n    ISettingResolver settingResolver\r\n) : RamshaApiController\r\n{\r\n    [HttpGet(nameof(GetProductDiscountSettings))]\r\n    public async Task<ProductDiscountSettings?> GetProductDiscountSettings()\r\n    {\r\n        return await settingResolver.ResolveAsync<ProductDiscountSettings>(\r\n            ProductSettingNames.DiscountSettings\r\n        );\r\n    }\r\n}\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Finds the setting definition"}),"\n",(0,r.jsx)(n.li,{children:"Applies provider filtering"}),"\n",(0,r.jsx)(n.li,{children:"Executes resolvers in order"}),"\n",(0,r.jsx)(n.li,{children:"Returns strongly typed value"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsx)(n.p,{children:"Ramsha Settings System:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Centralizes settings definitions"}),"\n",(0,r.jsx)(n.li,{children:"Supports multiple value sources via resolvers"}),"\n",(0,r.jsxs)(n.li,{children:["Provides fine-grained control over ",(0,r.jsx)(n.strong,{children:"resolver order"})]}),"\n",(0,r.jsxs)(n.li,{children:["Allows ",(0,r.jsx)(n.strong,{children:"custom resolvers"})]}),"\n",(0,r.jsxs)(n.li,{children:["Supports ",(0,r.jsx)(n.strong,{children:"provider-based filtering"})]}),"\n",(0,r.jsx)(n.li,{children:"Provides safe defaults"}),"\n",(0,r.jsxs)(n.li,{children:["Ensures ",(0,r.jsx)(n.strong,{children:"explicit, predictable, and strongly typed configuration"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"This design makes your configuration:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Clear"}),"\n",(0,r.jsx)(n.li,{children:"Maintainable"}),"\n",(0,r.jsx)(n.li,{children:"Flexible"}),"\n",(0,r.jsx)(n.li,{children:"Fully aligned with Clean Architecture principles"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"./authorization",children:"Authorization"})})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"../basics/messaging/local-messaging",children:"Local Messaging"})})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}}}]);